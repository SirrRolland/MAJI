<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absensi Siswa MAJI</title>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-database.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            padding: 20px;
        }
        #studentList {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
            background: white;
        }
        .student {
            margin: 5px 0;
        }
        button {
            margin: 5px;
            padding: 10px;
            font-size: 16px;
        }
        #exitMessage {
            display: none;
            font-size: 24px;
            color: green;
        }
    </style>
</head>
<body>
    <h1>Absensi Siswa</h1>
    <div id="studentList">Daftar Siswa:</div>
    <button id="markPresentButton" onclick="markPresent()">Tandai Pulang</button>
    <button id="exitButton" onclick="exitApp()">Keluar</button>
    <audio id="backgroundMusic" loop>
        <source src="music/Himawari_No_Yakusoku(256k).mp3" type="audio/mp3">
    </audio>
    <div id="exitMessage">Sampai Jumpa!</div>

    <script>
        // Konfigurasi Firebase Anda
        const firebaseConfig = {
            apiKey: "AIzaSyDagk7NSN2KjYQ6JUHBTeMpYuIj2nMv-Co",
            authDomain: "students-70440.firebaseapp.com",
            databaseURL: "https://students-70440-default-rtdb.firebaseio.com/",
            projectId: "students-70440",
            storageBucket: "students-70440.appspot.com",
            messagingSenderId: "884830572053",
            appId: "1:884830572053:android:3f9708bde3d7df80b1881c"
        };

        // Inisialisasi Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Memulai musik saat aplikasi dimuat
        window.onload = function() {
            document.getElementById('backgroundMusic').play();
            loadStudents(); // Panggil fungsi untuk memuat daftar siswa
        };

        // Fungsi untuk memuat daftar siswa dari Firebase
        function loadStudents() {
            const studentListDiv = document.getElementById('studentList');
            database.ref('students').once('value').then((snapshot) => {
                console.log("Data siswa berhasil dimuat.");
                studentListDiv.innerHTML = "Daftar Siswa:"; // Kosongkan daftar siswa sebelum memuat
                snapshot.forEach((childSnapshot) => {
                    const student = childSnapshot.val();
                    const studentDiv = document.createElement('div');
                    studentDiv.className = "student"; // Tambahkan kelas untuk styling
                    studentDiv.innerText = student.name; // Ambil nama siswa dari data Firebase
                    studentListDiv.appendChild(studentDiv);
                });
            }).catch((error) => {
                console.error("Error loading students:", error);
            });
        }

        // Fungsi untuk menandai siswa pulang
        function markPresent() {
            alert("Siswa sudah pulang! Boleh pulang lagi 2 Minggu setelah sekarang.");
            document.getElementById('markPresentButton').innerText = "Sudah Pulang";
            // Tambahkan kode untuk menyimpan data absensi ke Firebase
        }

        // Fungsi untuk keluar dari aplikasi
        function exitApp() {
            document.getElementById('studentList').style.display = 'none';
            document.getElementById('markPresentButton').style.display = 'none';
            document.getElementById('exitButton').style.display = 'none';
            document.getElementById('exitMessage').style.display = 'block';
            document.getElementById('backgroundMusic').pause();
        }
    </script>
</body>
</html>
